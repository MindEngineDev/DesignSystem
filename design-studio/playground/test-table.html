<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Test  Table</title>
    <link rel="stylesheet" href="../../main.css" />
    <script src="https://cdn.jsdelivr.net/npm/ag-grid-community@31.3.3/dist/ag-grid-community.min.noStyle.js"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <!-- removed duplicate local site.css and external icon/theme CSS; use ../../main.css only -->
  <link rel="stylesheet" href="../assets/css/site.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@31.3.3/styles/ag-grid.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@31.3.3/styles/ag-theme-alpine.min.css">
  <link rel="stylesheet" href="../assets/css/https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace/dist/themes/dark.css">
  <script>window.__shoelace_base_url="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace/dist/";</script>
  <script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace/dist/shoelace.js"></script>
</head>
  <body>
<!-- SIDEBAR START -->
<script>document.body.classList.add('has-sidebar');</script>
<aside class="sidebar" x-data>
  <div class="brand"><span class="dot"></span><span>Design Studio</span></div>
  <div class="group">
    <h6>Playground</h6>
    <a href="../../index.html"><i class="fa-solid fa-house"></i> Home</a>
    <a href="./test-dashboard.html"><i class="fa-solid fa-gauge"></i> Dashboard</a>
    <a href="./test-forms.html"><i class="fa-solid fa-sliders"></i> Forms</a>
    <a href="./test-table.html"><i class="fa-solid fa-table"></i> Table</a>
    <a href="./test-components.html"><i class="fa-solid fa-cubes"></i> Components</a>
  </div>
  <div class="group">
    <h6>Views</h6>
    <a href="./test-dashboard.html#phone"><i class="fa-solid fa-mobile-screen"></i> Phone Preview</a>
  </div>
  <div class="footer">© Mind Engine</div>
</aside>
<div class="main-wrap" x-data="{ m:false }">
  <button class="icon-btn" @click="document.body.classList.toggle('sidebar-open')" aria-label="Toggle sidebar" style="position:fixed;left:.75rem;bottom:.75rem;z-index:95">
    <i class="fa-solid fa-bars"></i>
  </button>
<!-- SIDEBAR END -->
<div class="sb-backdrop" onclick="document.body.classList.remove(0)"></div>
    <!-- Header -->
    <header class="header">
      <strong class="brand">
        <i class="fa-solid fa-table"></i>
        Table
      </strong>
      <span class="spacer"></span>
      <nav>
        <a href="./test-dashboard.html" class="contrast">Dashboard</a>
        ·
        <a href="./test-forms.html" class="contrast">Forms</a>
        ·
        <a href="./test-components.html" class="contrast">Components</a>
      </nav>
    </header>
    <!-- Main -->
    <main class="container" data-pad-applied>
  <div style="padding: 1rem 0 2rem;"></div>
      <!-- AGGRID-DEMO -->
      <section class="card">
        <div class="toolbar">
          <div class="muted">
            <i class="fa-solid fa-table"></i>
            Users
          </div>
          <div>
            <input id="qf" type="search" placeholder="Quick filter…" />
            <span class="pill" id="count">0 rows</span>
          </div>
        </div>
          <div class="table-wrap"><div id="agGrid" class="ag-theme-alpine" style="height: 480px; min-width: 640px; background: var(--surface-2, #0e1417); border-radius:6px; padding:6px"><div class="grid-loading">Loading…</div></div>
          <div id="agFallback" class="muted" style="padding:.75rem;display:none">Table failed to initialize — check console for errors.</div>
        </div>
      </section>
    </main>
  </body>
</html>
<script>
  (function () {
    if (typeof agGrid === "undefined") return;
    const columnDefs = [
      { headerName: "ID", field: "id", width: 90 },
      { headerName: "Name", field: "name", flex: 1 },
      { headerName: "Email", field: "email", flex: 1 },
      { headerName: "Status", field: "status", width: 120 },
    ];
    const initialRows = [
      { id: 1, name: "Ada Lovelace", email: "ada@engine.io", status: "active" },
      { id: 2, name: "Alan Turing", email: "alan@engine.io", status: "pending" },
      { id: 3, name: "Grace Hopper", email: "grace@engine.io", status: "inactive" },
    ];
    const getRowId = (params) => params.data.id;

    const gridOptions = {
      columnDefs,
      rowData: initialRows,
      animateRows: true,
      deltaRowDataMode: true,
      getRowId,
      defaultColDef: { sortable: true, filter: true, resizable: true },
    };

    const eGridDiv = document.querySelector("#agGrid");

    let _gridInitialized = false;
    const debounce = (fn, wait = 250) => { let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), wait); }; };
    const initGrid = () => {
      if (_gridInitialized) return;
      if (!eGridDiv) return;
      try {
        new agGrid.Grid(eGridDiv, gridOptions);
        // remove loader
        const loader = eGridDiv.querySelector('.grid-loading'); if (loader) loader.remove();
        _gridInitialized = true;
      } catch (err) {
        const fallback = document.getElementById('agFallback'); if (fallback) { fallback.style.display = 'block'; fallback.textContent = 'Table failed to initialize: ' + (err && err.message ? err.message : 'unknown'); }
        console.error('AG Grid init error', err);
        return;
      }
    };

    // Initialize grid immediately for the playground so demos are visible
    initGrid();

    // If the grid API is available update the row counter and keep it in sync
    const updateCount = () => {
      const c = document.getElementById('count');
      if (!c) return;
      if (gridOptions.api) c.textContent = (gridOptions.api.getDisplayedRowCount() || 0) + ' rows';
    };

    // If api is present now, set initial count and hook model updates
    if (gridOptions.api) {
      updateCount();
      gridOptions.api.addEventListener && gridOptions.api.addEventListener('modelUpdated', updateCount);
    } else {
      // try to set when ready
      const readyCheck = setInterval(() => {
        if (gridOptions.api) {
          updateCount();
          gridOptions.api.addEventListener && gridOptions.api.addEventListener('modelUpdated', updateCount);
          clearInterval(readyCheck);
        }
      }, 150);
      // safety stop
      setTimeout(() => clearInterval(readyCheck), 3000);
    }

    // Wire quick-filter input with debounce when grid API is ready
    (function attachQuickFilter() {
      const q = document.getElementById('qf');
      if (!q) return;
      const install = () => {
        if (!gridOptions.api) return false;
        const deb = debounce(() => gridOptions.api.setQuickFilter(q.value || ''), 250);
        q.addEventListener('input', deb);
        return true;
      };
      if (!install()) {
        const h = setInterval(() => { if (install()) clearInterval(h); }, 150);
        setTimeout(() => clearInterval(h), 5000);
      }
    })();

    // expose small helpers for demo pager buttons (if they exist)
    window.__agGridHelpers = {
      addRow() {
        if (!gridOptions.api) return;
        const next = { id: Date.now() % 100000, name: "New User", email: "new@engine.io", status: "active" };
        gridOptions.api.applyTransaction({ add: [next] });
      },
      setRows(rows) {
        if (!gridOptions.api) return;
        gridOptions.api.setRowData(rows);
      },
    };
  })();
</script>
<!-- MAIN-WRAP END -->
</div><!-- .main-wrap -->

<!-- SIDEBAR-ACTIVE-HILITE -->
<script>
(() => {
  const p = location.pathname.replace(/\/+$/,'').toLowerCase();
  document.querySelectorAll('.sidebar a').forEach(a => {
    try {
      const u = new URL(a.href, location.href);
      if (p.endsWith(u.pathname.replace(/\/+$/,'').toLowerCase())) a.classList.add('active');
    } catch (_) {}
  });
})();
</script>

